"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/magic/searchKey";
exports.ids = ["pages/api/magic/searchKey"];
exports.modules = {

/***/ "algoliasearch":
/*!********************************!*\
  !*** external "algoliasearch" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("algoliasearch");

/***/ }),

/***/ "firebase-admin":
/*!*********************************!*\
  !*** external "firebase-admin" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("firebase-admin");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmagic%2FsearchKey&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmagic%2FsearchKey.ts&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmagic%2FsearchKey&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmagic%2FsearchKey.ts&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_magic_searchKey_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/magic/searchKey.ts */ \"(api)/./src/pages/api/magic/searchKey.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_magic_searchKey_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_magic_searchKey_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/magic/searchKey\",\n        pathname: \"/api/magic/searchKey\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_magic_searchKey_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRm1hZ2ljJTJGc2VhcmNoS2V5JnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGc3JjJTJGcGFnZXMlMkZhcGklMkZtYWdpYyUyRnNlYXJjaEtleS50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUMrRDtBQUMvRDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsOERBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLDhEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL3R5cGVtYWdpYy1haS8/YWZiOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjL3BhZ2VzL2FwaS9tYWdpYy9zZWFyY2hLZXkudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9tYWdpYy9zZWFyY2hLZXlcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9tYWdpYy9zZWFyY2hLZXlcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmagic%2FsearchKey&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmagic%2FsearchKey.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/api-utils/db.ts":
/*!***************************************!*\
  !*** ./src/pages/api/api-utils/db.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   admin: () => (/* reexport default from dynamic */ firebase_admin__WEBPACK_IMPORTED_MODULE_0___default.a),\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   getUserIdForEmail: () => (/* binding */ getUserIdForEmail),\n/* harmony export */   verifyIdToken: () => (/* binding */ verifyIdToken)\n/* harmony export */ });\n/* harmony import */ var firebase_admin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase-admin */ \"firebase-admin\");\n/* harmony import */ var firebase_admin__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(firebase_admin__WEBPACK_IMPORTED_MODULE_0__);\n\n// Note re. the private key formatting: https://github.com/gladly-team/next-firebase-auth/discussions/95#discussioncomment-2891225\nlet serviceAccount = {\n    type: \"service_account\",\n    project_id: process.env.FIREBASE_PROJECT_ID,\n    private_key_id: process.env.FIREBASE_PRIVATE_KEY_ID,\n    privateKey: process.env.FIREBASE_PRIVATE_KEY ? process.env.FIREBASE_PRIVATE_KEY.replace(/\\\\n/gm, \"\\n\") : undefined,\n    client_email: \"firebase-adminsdk-z0cf9@typemagic-18c6c.iam.gserviceaccount.com\",\n    client_id: \"111905503050827831487\",\n    auth_uri: \"https://accounts.google.com/o/oauth2/auth\",\n    token_uri: \"https://oauth2.googleapis.com/token\",\n    auth_provider_x509_cert_url: \"https://www.googleapis.com/oauth2/v1/certs\",\n    client_x509_cert_url: \"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-z0cf9%40typemagic-18c6c.iam.gserviceaccount.com\"\n};\nif ((firebase_admin__WEBPACK_IMPORTED_MODULE_0___default().apps).length === 0) {\n    firebase_admin__WEBPACK_IMPORTED_MODULE_0___default().initializeApp({\n        credential: firebase_admin__WEBPACK_IMPORTED_MODULE_0___default().credential.cert(serviceAccount)\n    });\n}\nconst db = firebase_admin__WEBPACK_IMPORTED_MODULE_0___default().firestore();\ntry {\n    db.settings({\n        ignoreUndefinedProperties: true\n    });\n} catch (e) {}\nconst verifyIdToken = async (idToken)=>{\n    let userId = undefined;\n    try {\n        const decodedToken = await firebase_admin__WEBPACK_IMPORTED_MODULE_0___default().auth().verifyIdToken(idToken);\n        userId = decodedToken.uid;\n    } catch (error) {\n        return undefined;\n    }\n    return userId;\n};\nconst getUserIdForEmail = async (email)=>{\n    const snapshot = await db.collection(\"users\").where(\"email\", \"==\", email).get();\n    if (snapshot.empty) {\n        console.log(\"dafuq, no user? \", email);\n        return undefined;\n    }\n    const userId = snapshot.docs[0].id;\n    return userId;\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL2FwaS11dGlscy9kYi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBbUM7QUFFbkMsa0lBQWtJO0FBQ2xJLElBQUlDLGlCQUFpQjtJQUNuQkMsTUFBTTtJQUNOQyxZQUFZQyxRQUFRQyxHQUFHLENBQUNDLG1CQUFtQjtJQUMzQ0MsZ0JBQWdCSCxRQUFRQyxHQUFHLENBQUNHLHVCQUF1QjtJQUNuREMsWUFBWUwsUUFBUUMsR0FBRyxDQUFDSyxvQkFBb0IsR0FDeENOLFFBQVFDLEdBQUcsQ0FBQ0ssb0JBQW9CLENBQUNDLE9BQU8sQ0FBQyxTQUFTLFFBQ2xEQztJQUNKQyxjQUNFO0lBQ0ZDLFdBQVc7SUFDWEMsVUFBVTtJQUNWQyxXQUFXO0lBQ1hDLDZCQUE2QjtJQUM3QkMsc0JBQ0U7QUFDSjtBQUNBLElBQUlsQiw0REFBVSxDQUFDb0IsTUFBTSxLQUFLLEdBQUc7SUFDM0JwQixtRUFBbUIsQ0FBQztRQUNsQnNCLFlBQVl0QixnRUFBZ0IsQ0FBQ3VCLElBQUksQ0FBQ3RCO0lBQ3BDO0FBQ0Y7QUFFQSxNQUFNdUIsS0FBS3hCLCtEQUFlO0FBRTFCLElBQUk7SUFDRndCLEdBQUdFLFFBQVEsQ0FBQztRQUFFQywyQkFBMkI7SUFBSztBQUNoRCxFQUFFLE9BQU9DLEdBQUcsQ0FBQztBQUVOLE1BQU1DLGdCQUFnQixPQUFPQztJQUNsQyxJQUFJQyxTQUFTbkI7SUFDYixJQUFJO1FBQ0YsTUFBTW9CLGVBQWUsTUFBTWhDLDBEQUFVLEdBQUc2QixhQUFhLENBQUNDO1FBQ3REQyxTQUFTQyxhQUFhRSxHQUFHO0lBQzNCLEVBQUUsT0FBT0MsT0FBTztRQUNkLE9BQU92QjtJQUNUO0lBQ0EsT0FBT21CO0FBQ1QsRUFBRTtBQUVLLE1BQU1LLG9CQUFvQixPQUFPQztJQUN0QyxNQUFNQyxXQUFXLE1BQU1kLEdBQ3BCZSxVQUFVLENBQUMsU0FDWEMsS0FBSyxDQUFDLFNBQVMsTUFBTUgsT0FDckJJLEdBQUc7SUFFTixJQUFJSCxTQUFTSSxLQUFLLEVBQUU7UUFDbEJDLFFBQVFDLEdBQUcsQ0FBQyxvQkFBb0JQO1FBQ2hDLE9BQU96QjtJQUNUO0lBQ0EsTUFBTW1CLFNBQVNPLFNBQVNPLElBQUksQ0FBQyxFQUFFLENBQUNDLEVBQUU7SUFDbEMsT0FBT2Y7QUFDVCxFQUFFO0FBRW1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHlwZW1hZ2ljLWFpLy4vc3JjL3BhZ2VzL2FwaS9hcGktdXRpbHMvZGIudHM/YTIxMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYWRtaW4gZnJvbSBcImZpcmViYXNlLWFkbWluXCI7XG5cbi8vIE5vdGUgcmUuIHRoZSBwcml2YXRlIGtleSBmb3JtYXR0aW5nOiBodHRwczovL2dpdGh1Yi5jb20vZ2xhZGx5LXRlYW0vbmV4dC1maXJlYmFzZS1hdXRoL2Rpc2N1c3Npb25zLzk1I2Rpc2N1c3Npb25jb21tZW50LTI4OTEyMjVcbmxldCBzZXJ2aWNlQWNjb3VudCA9IHtcbiAgdHlwZTogXCJzZXJ2aWNlX2FjY291bnRcIixcbiAgcHJvamVjdF9pZDogcHJvY2Vzcy5lbnYuRklSRUJBU0VfUFJPSkVDVF9JRCxcbiAgcHJpdmF0ZV9rZXlfaWQ6IHByb2Nlc3MuZW52LkZJUkVCQVNFX1BSSVZBVEVfS0VZX0lELFxuICBwcml2YXRlS2V5OiBwcm9jZXNzLmVudi5GSVJFQkFTRV9QUklWQVRFX0tFWVxuICAgID8gcHJvY2Vzcy5lbnYuRklSRUJBU0VfUFJJVkFURV9LRVkucmVwbGFjZSgvXFxcXG4vZ20sIFwiXFxuXCIpXG4gICAgOiB1bmRlZmluZWQsXG4gIGNsaWVudF9lbWFpbDpcbiAgICBcImZpcmViYXNlLWFkbWluc2RrLXowY2Y5QHR5cGVtYWdpYy0xOGM2Yy5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbVwiLFxuICBjbGllbnRfaWQ6IFwiMTExOTA1NTAzMDUwODI3ODMxNDg3XCIsXG4gIGF1dGhfdXJpOiBcImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9vL29hdXRoMi9hdXRoXCIsXG4gIHRva2VuX3VyaTogXCJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlblwiLFxuICBhdXRoX3Byb3ZpZGVyX3g1MDlfY2VydF91cmw6IFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YxL2NlcnRzXCIsXG4gIGNsaWVudF94NTA5X2NlcnRfdXJsOlxuICAgIFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vcm9ib3QvdjEvbWV0YWRhdGEveDUwOS9maXJlYmFzZS1hZG1pbnNkay16MGNmOSU0MHR5cGVtYWdpYy0xOGM2Yy5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbVwiLFxufTtcbmlmIChhZG1pbi5hcHBzLmxlbmd0aCA9PT0gMCkge1xuICBhZG1pbi5pbml0aWFsaXplQXBwKHtcbiAgICBjcmVkZW50aWFsOiBhZG1pbi5jcmVkZW50aWFsLmNlcnQoc2VydmljZUFjY291bnQgYXMgYWRtaW4uU2VydmljZUFjY291bnQpLFxuICB9KTtcbn1cblxuY29uc3QgZGIgPSBhZG1pbi5maXJlc3RvcmUoKTtcblxudHJ5IHtcbiAgZGIuc2V0dGluZ3MoeyBpZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzOiB0cnVlIH0pO1xufSBjYXRjaCAoZSkge31cblxuZXhwb3J0IGNvbnN0IHZlcmlmeUlkVG9rZW4gPSBhc3luYyAoaWRUb2tlbjogc3RyaW5nKSA9PiB7XG4gIGxldCB1c2VySWQgPSB1bmRlZmluZWQ7XG4gIHRyeSB7XG4gICAgY29uc3QgZGVjb2RlZFRva2VuID0gYXdhaXQgYWRtaW4uYXV0aCgpLnZlcmlmeUlkVG9rZW4oaWRUb2tlbik7XG4gICAgdXNlcklkID0gZGVjb2RlZFRva2VuLnVpZDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIHJldHVybiB1c2VySWQ7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0VXNlcklkRm9yRW1haWwgPSBhc3luYyAoZW1haWw6IHN0cmluZykgPT4ge1xuICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGRiXG4gICAgLmNvbGxlY3Rpb24oXCJ1c2Vyc1wiKVxuICAgIC53aGVyZShcImVtYWlsXCIsIFwiPT1cIiwgZW1haWwpXG4gICAgLmdldCgpO1xuXG4gIGlmIChzbmFwc2hvdC5lbXB0eSkge1xuICAgIGNvbnNvbGUubG9nKFwiZGFmdXEsIG5vIHVzZXI/IFwiLCBlbWFpbCk7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBjb25zdCB1c2VySWQgPSBzbmFwc2hvdC5kb2NzWzBdLmlkO1xuICByZXR1cm4gdXNlcklkO1xufTtcblxuZXhwb3J0IHsgZGIsIGFkbWluIH07XG4iXSwibmFtZXMiOlsiYWRtaW4iLCJzZXJ2aWNlQWNjb3VudCIsInR5cGUiLCJwcm9qZWN0X2lkIiwicHJvY2VzcyIsImVudiIsIkZJUkVCQVNFX1BST0pFQ1RfSUQiLCJwcml2YXRlX2tleV9pZCIsIkZJUkVCQVNFX1BSSVZBVEVfS0VZX0lEIiwicHJpdmF0ZUtleSIsIkZJUkVCQVNFX1BSSVZBVEVfS0VZIiwicmVwbGFjZSIsInVuZGVmaW5lZCIsImNsaWVudF9lbWFpbCIsImNsaWVudF9pZCIsImF1dGhfdXJpIiwidG9rZW5fdXJpIiwiYXV0aF9wcm92aWRlcl94NTA5X2NlcnRfdXJsIiwiY2xpZW50X3g1MDlfY2VydF91cmwiLCJhcHBzIiwibGVuZ3RoIiwiaW5pdGlhbGl6ZUFwcCIsImNyZWRlbnRpYWwiLCJjZXJ0IiwiZGIiLCJmaXJlc3RvcmUiLCJzZXR0aW5ncyIsImlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMiLCJlIiwidmVyaWZ5SWRUb2tlbiIsImlkVG9rZW4iLCJ1c2VySWQiLCJkZWNvZGVkVG9rZW4iLCJhdXRoIiwidWlkIiwiZXJyb3IiLCJnZXRVc2VySWRGb3JFbWFpbCIsImVtYWlsIiwic25hcHNob3QiLCJjb2xsZWN0aW9uIiwid2hlcmUiLCJnZXQiLCJlbXB0eSIsImNvbnNvbGUiLCJsb2ciLCJkb2NzIiwiaWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/api-utils/db.ts\n");

/***/ }),

/***/ "(api)/./src/pages/api/api-utils/magic/algolia.ts":
/*!**************************************************!*\
  !*** ./src/pages/api/api-utils/magic/algolia.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   algoliaIndexAgent: () => (/* binding */ algoliaIndexAgent),\n/* harmony export */   algoliaUpdate: () => (/* binding */ algoliaUpdate),\n/* harmony export */   getSearchKey: () => (/* binding */ getSearchKey),\n/* harmony export */   removeAgentAlgolia: () => (/* binding */ removeAgentAlgolia)\n/* harmony export */ });\n/* harmony import */ var algoliasearch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! algoliasearch */ \"algoliasearch\");\n/* harmony import */ var algoliasearch__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(algoliasearch__WEBPACK_IMPORTED_MODULE_0__);\n// For the default version\n\n// For the default version\n// import algoliasearch from 'algoliasearch';\n// For the search only version\n// import algoliasearch from 'algoliasearch/lite';\nconst getIndex = ()=>{\n    const client = algoliasearch__WEBPACK_IMPORTED_MODULE_0___default()(\"P2GVB0HBVC\", process.env.ALGOLIA_ADMIN_KEY);\n    const index = client.initIndex(\"agents\");\n    return index;\n};\nconst algoliaIndexAgent = async (agent)=>{\n    const index = getIndex();\n    await index.saveObject({\n        objectID: agent.id,\n        name: agent.name,\n        humanReadableId: agent.humanReadableId,\n        description: agent.description,\n        creatorHandle: agent.creatorHandle,\n        creatorId: agent.creatorId,\n        creatorPicture: agent.creatorPicture || \"\",\n        isPublic: agent.isPublic,\n        status: agent.status,\n        likes: agent.likes\n    });\n    console.log(\"Algolia saved.\");\n};\nconst getSearchKey = (userId)=>{\n    const client = algoliasearch__WEBPACK_IMPORTED_MODULE_0___default()(\"P2GVB0HBVC\", process.env.ALGOLIA_ADMIN_KEY);\n    const key = client.generateSecuredApiKey(process.env.NEXT_PUBLIC_ALGOLIA_SEARCH_KEY, {\n        filters: `(creatorId:${userId} OR isPublic:true)`\n    });\n    return key;\n};\nconst removeAgentAlgolia = async (agentId)=>{\n    const index = getIndex();\n    await index.deleteObject(agentId);\n    console.log(\"Algolia deleted.\");\n};\nconst algoliaUpdate = async (agentId, fields)=>{\n    const index = getIndex();\n    await index.partialUpdateObject({\n        objectID: agentId,\n        ...fields\n    });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL2FwaS11dGlscy9tYWdpYy9hbGdvbGlhLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUVBLDBCQUEwQjtBQUNnQjtBQUUxQywwQkFBMEI7QUFDMUIsNkNBQTZDO0FBRTdDLDhCQUE4QjtBQUM5QixrREFBa0Q7QUFFbEQsTUFBTUMsV0FBVztJQUNmLE1BQU1DLFNBQVNGLG9EQUFhQSxDQUFDLGNBQWNHLFFBQVFDLEdBQUcsQ0FBQ0MsaUJBQWlCO0lBQ3hFLE1BQU1DLFFBQVFKLE9BQU9LLFNBQVMsQ0FBQztJQUMvQixPQUFPRDtBQUNUO0FBRU8sTUFBTUUsb0JBQW9CLE9BQU9DO0lBQ3RDLE1BQU1ILFFBQVFMO0lBQ2QsTUFBTUssTUFBTUksVUFBVSxDQUFDO1FBQ3JCQyxVQUFVRixNQUFNRyxFQUFFO1FBQ2xCQyxNQUFNSixNQUFNSSxJQUFJO1FBQ2hCQyxpQkFBaUJMLE1BQU1LLGVBQWU7UUFDdENDLGFBQWFOLE1BQU1NLFdBQVc7UUFDOUJDLGVBQWVQLE1BQU1PLGFBQWE7UUFDbENDLFdBQVdSLE1BQU1RLFNBQVM7UUFDMUJDLGdCQUFnQlQsTUFBTVMsY0FBYyxJQUFJO1FBQ3hDQyxVQUFVVixNQUFNVSxRQUFRO1FBQ3hCQyxRQUFRWCxNQUFNVyxNQUFNO1FBQ3BCQyxPQUFPWixNQUFNWSxLQUFLO0lBQ3BCO0lBQ0FDLFFBQVFDLEdBQUcsQ0FBQztBQUNkLEVBQUU7QUFFSyxNQUFNQyxlQUFlLENBQUNDO0lBQzNCLE1BQU12QixTQUFTRixvREFBYUEsQ0FBQyxjQUFjRyxRQUFRQyxHQUFHLENBQUNDLGlCQUFpQjtJQUN4RSxNQUFNcUIsTUFBTXhCLE9BQU95QixxQkFBcUIsQ0FDdEN4QixRQUFRQyxHQUFHLENBQUN3Qiw4QkFBOEIsRUFDMUM7UUFDRUMsU0FBUyxDQUFDLFdBQVcsRUFBRUosT0FBTyxrQkFBa0IsQ0FBQztJQUNuRDtJQUVGLE9BQU9DO0FBQ1QsRUFBRTtBQUVLLE1BQU1JLHFCQUFxQixPQUFPQztJQUN2QyxNQUFNekIsUUFBUUw7SUFDZCxNQUFNSyxNQUFNMEIsWUFBWSxDQUFDRDtJQUN6QlQsUUFBUUMsR0FBRyxDQUFDO0FBQ2QsRUFBRTtBQUVLLE1BQU1VLGdCQUFnQixPQUMzQkYsU0FDQUc7SUFFQSxNQUFNNUIsUUFBUUw7SUFDZCxNQUFNSyxNQUFNNkIsbUJBQW1CLENBQUM7UUFDOUJ4QixVQUFVb0I7UUFDVixHQUFHRyxNQUFNO0lBQ1g7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHlwZW1hZ2ljLWFpLy4vc3JjL3BhZ2VzL2FwaS9hcGktdXRpbHMvbWFnaWMvYWxnb2xpYS50cz81ZjljIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFnZW50IH0gZnJvbSBcIkAvdXRpbHMvdHlwZXNcIjtcblxuLy8gRm9yIHRoZSBkZWZhdWx0IHZlcnNpb25cbmltcG9ydCBhbGdvbGlhc2VhcmNoIGZyb20gXCJhbGdvbGlhc2VhcmNoXCI7XG5cbi8vIEZvciB0aGUgZGVmYXVsdCB2ZXJzaW9uXG4vLyBpbXBvcnQgYWxnb2xpYXNlYXJjaCBmcm9tICdhbGdvbGlhc2VhcmNoJztcblxuLy8gRm9yIHRoZSBzZWFyY2ggb25seSB2ZXJzaW9uXG4vLyBpbXBvcnQgYWxnb2xpYXNlYXJjaCBmcm9tICdhbGdvbGlhc2VhcmNoL2xpdGUnO1xuXG5jb25zdCBnZXRJbmRleCA9ICgpID0+IHtcbiAgY29uc3QgY2xpZW50ID0gYWxnb2xpYXNlYXJjaChcIlAyR1ZCMEhCVkNcIiwgcHJvY2Vzcy5lbnYuQUxHT0xJQV9BRE1JTl9LRVkhKTtcbiAgY29uc3QgaW5kZXggPSBjbGllbnQuaW5pdEluZGV4KFwiYWdlbnRzXCIpO1xuICByZXR1cm4gaW5kZXg7XG59O1xuXG5leHBvcnQgY29uc3QgYWxnb2xpYUluZGV4QWdlbnQgPSBhc3luYyAoYWdlbnQ6IEFnZW50KSA9PiB7XG4gIGNvbnN0IGluZGV4ID0gZ2V0SW5kZXgoKTtcbiAgYXdhaXQgaW5kZXguc2F2ZU9iamVjdCh7XG4gICAgb2JqZWN0SUQ6IGFnZW50LmlkLFxuICAgIG5hbWU6IGFnZW50Lm5hbWUsXG4gICAgaHVtYW5SZWFkYWJsZUlkOiBhZ2VudC5odW1hblJlYWRhYmxlSWQsXG4gICAgZGVzY3JpcHRpb246IGFnZW50LmRlc2NyaXB0aW9uLFxuICAgIGNyZWF0b3JIYW5kbGU6IGFnZW50LmNyZWF0b3JIYW5kbGUsXG4gICAgY3JlYXRvcklkOiBhZ2VudC5jcmVhdG9ySWQsXG4gICAgY3JlYXRvclBpY3R1cmU6IGFnZW50LmNyZWF0b3JQaWN0dXJlIHx8IFwiXCIsXG4gICAgaXNQdWJsaWM6IGFnZW50LmlzUHVibGljLFxuICAgIHN0YXR1czogYWdlbnQuc3RhdHVzLFxuICAgIGxpa2VzOiBhZ2VudC5saWtlcyxcbiAgfSk7XG4gIGNvbnNvbGUubG9nKFwiQWxnb2xpYSBzYXZlZC5cIik7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0U2VhcmNoS2V5ID0gKHVzZXJJZDogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgY29uc3QgY2xpZW50ID0gYWxnb2xpYXNlYXJjaChcIlAyR1ZCMEhCVkNcIiwgcHJvY2Vzcy5lbnYuQUxHT0xJQV9BRE1JTl9LRVkhKTtcbiAgY29uc3Qga2V5ID0gY2xpZW50LmdlbmVyYXRlU2VjdXJlZEFwaUtleShcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BTEdPTElBX1NFQVJDSF9LRVkhLFxuICAgIHtcbiAgICAgIGZpbHRlcnM6IGAoY3JlYXRvcklkOiR7dXNlcklkfSBPUiBpc1B1YmxpYzp0cnVlKWAsXG4gICAgfVxuICApO1xuICByZXR1cm4ga2V5O1xufTtcblxuZXhwb3J0IGNvbnN0IHJlbW92ZUFnZW50QWxnb2xpYSA9IGFzeW5jIChhZ2VudElkOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgaW5kZXggPSBnZXRJbmRleCgpO1xuICBhd2FpdCBpbmRleC5kZWxldGVPYmplY3QoYWdlbnRJZCk7XG4gIGNvbnNvbGUubG9nKFwiQWxnb2xpYSBkZWxldGVkLlwiKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhbGdvbGlhVXBkYXRlID0gYXN5bmMgKFxuICBhZ2VudElkOiBzdHJpbmcsXG4gIGZpZWxkczogeyBba2V5OiBzdHJpbmddOiBhbnkgfVxuKSA9PiB7XG4gIGNvbnN0IGluZGV4ID0gZ2V0SW5kZXgoKTtcbiAgYXdhaXQgaW5kZXgucGFydGlhbFVwZGF0ZU9iamVjdCh7XG4gICAgb2JqZWN0SUQ6IGFnZW50SWQsXG4gICAgLi4uZmllbGRzLFxuICB9KTtcbn07XG4iXSwibmFtZXMiOlsiYWxnb2xpYXNlYXJjaCIsImdldEluZGV4IiwiY2xpZW50IiwicHJvY2VzcyIsImVudiIsIkFMR09MSUFfQURNSU5fS0VZIiwiaW5kZXgiLCJpbml0SW5kZXgiLCJhbGdvbGlhSW5kZXhBZ2VudCIsImFnZW50Iiwic2F2ZU9iamVjdCIsIm9iamVjdElEIiwiaWQiLCJuYW1lIiwiaHVtYW5SZWFkYWJsZUlkIiwiZGVzY3JpcHRpb24iLCJjcmVhdG9ySGFuZGxlIiwiY3JlYXRvcklkIiwiY3JlYXRvclBpY3R1cmUiLCJpc1B1YmxpYyIsInN0YXR1cyIsImxpa2VzIiwiY29uc29sZSIsImxvZyIsImdldFNlYXJjaEtleSIsInVzZXJJZCIsImtleSIsImdlbmVyYXRlU2VjdXJlZEFwaUtleSIsIk5FWFRfUFVCTElDX0FMR09MSUFfU0VBUkNIX0tFWSIsImZpbHRlcnMiLCJyZW1vdmVBZ2VudEFsZ29saWEiLCJhZ2VudElkIiwiZGVsZXRlT2JqZWN0IiwiYWxnb2xpYVVwZGF0ZSIsImZpZWxkcyIsInBhcnRpYWxVcGRhdGVPYmplY3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/api-utils/magic/algolia.ts\n");

/***/ }),

/***/ "(api)/./src/pages/api/magic/searchKey.ts":
/*!******************************************!*\
  !*** ./src/pages/api/magic/searchKey.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _api_utils_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../api-utils/db */ \"(api)/./src/pages/api/api-utils/db.ts\");\n/* harmony import */ var _api_utils_magic_algolia__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../api-utils/magic/algolia */ \"(api)/./src/pages/api/api-utils/magic/algolia.ts\");\n\n\nconst handler = async (req, res)=>{\n    let { idToken } = req.body;\n    if (!idToken) {\n        return res.status(400).send(\"Params yo!\");\n    }\n    const userId = await (0,_api_utils_db__WEBPACK_IMPORTED_MODULE_0__.verifyIdToken)(idToken);\n    if (!userId) return res.status(401).send(\"Unauthorized\");\n    const key = (0,_api_utils_magic_algolia__WEBPACK_IMPORTED_MODULE_1__.getSearchKey)(userId);\n    res.status(200).send({\n        key\n    });\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (handler);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL21hZ2ljL3NlYXJjaEtleS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFDb0Q7QUFDTTtBQUUxRCxNQUFNRSxVQUFVLE9BQU9DLEtBQW9CQztJQUN6QyxJQUFJLEVBQUVDLE9BQU8sRUFBRSxHQUFHRixJQUFJRyxJQUFJO0lBSTFCLElBQUksQ0FBQ0QsU0FBUztRQUNaLE9BQU9ELElBQUlHLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7SUFDOUI7SUFFQSxNQUFNQyxTQUFTLE1BQU1ULDREQUFhQSxDQUFDSztJQUNuQyxJQUFJLENBQUNJLFFBQVEsT0FBT0wsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztJQUN6QyxNQUFNRSxNQUFNVCxzRUFBWUEsQ0FBQ1E7SUFDekJMLElBQUlHLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7UUFBRUU7SUFBSTtBQUM3QjtBQUVBLGlFQUFlUixPQUFPQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdHlwZW1hZ2ljLWFpLy4vc3JjL3BhZ2VzL2FwaS9tYWdpYy9zZWFyY2hLZXkudHM/NjcxOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWZXJjZWxSZXF1ZXN0LCBWZXJjZWxSZXNwb25zZSB9IGZyb20gXCJAdmVyY2VsL25vZGVcIjtcbmltcG9ydCB7IGRiLCB2ZXJpZnlJZFRva2VuIH0gZnJvbSBcIi4uL2FwaS11dGlscy9kYlwiO1xuaW1wb3J0IHsgZ2V0U2VhcmNoS2V5IH0gZnJvbSBcIi4uL2FwaS11dGlscy9tYWdpYy9hbGdvbGlhXCI7XG5cbmNvbnN0IGhhbmRsZXIgPSBhc3luYyAocmVxOiBWZXJjZWxSZXF1ZXN0LCByZXM6IFZlcmNlbFJlc3BvbnNlKSA9PiB7XG4gIGxldCB7IGlkVG9rZW4gfSA9IHJlcS5ib2R5IGFzIHtcbiAgICBpZFRva2VuOiBzdHJpbmc7XG4gIH07XG5cbiAgaWYgKCFpZFRva2VuKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKFwiUGFyYW1zIHlvIVwiKTtcbiAgfVxuXG4gIGNvbnN0IHVzZXJJZCA9IGF3YWl0IHZlcmlmeUlkVG9rZW4oaWRUb2tlbik7XG4gIGlmICghdXNlcklkKSByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoXCJVbmF1dGhvcml6ZWRcIik7XG4gIGNvbnN0IGtleSA9IGdldFNlYXJjaEtleSh1c2VySWQpO1xuICByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IGtleSB9KTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGhhbmRsZXI7XG4iXSwibmFtZXMiOlsidmVyaWZ5SWRUb2tlbiIsImdldFNlYXJjaEtleSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJpZFRva2VuIiwiYm9keSIsInN0YXR1cyIsInNlbmQiLCJ1c2VySWQiLCJrZXkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/magic/searchKey.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmagic%2FsearchKey&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmagic%2FsearchKey.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();